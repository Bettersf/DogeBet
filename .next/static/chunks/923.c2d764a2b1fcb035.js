"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[923],{3923:function(t,e,n){n.r(e),n.d(e,{default:function(){return k}});var i=n(7568),r=n(253),o=n(7582),l=n(5893),a=n(1355);var s=n(9815),u=n(9842),c=n.n(u),h=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=700,this.height=700,this.engine=c().Engine.create({gravity:{y:1},timing:{timeScale:1}}),this.runner=c().Runner.create(),this.ballComposite=c().Composite.create(),this.bucketComposite=c().Composite.create(),this.makePlinko=function(t,e){var i=n.width/2+t;return c().Bodies.circle(i,-10,9,{restitution:.4,collisionFilter:{group:-6969},label:"Plinko",plugin:{startPositionIndex:e}})},this.collisionHandler=function(t){var e={},i=!0,r=!1,o=void 0;try{for(var l,a=function(){var t=l.value,n=function(n,i){t.bodyA.label===i&&(e[n]=t.bodyA),t.bodyB.label===i&&(e[n]=t.bodyB)};n("peg","Peg"),n("bucket","Bucket"),n("barrier","Barrier"),n("plinko","Plinko")},s=t.pairs[Symbol.iterator]();!(i=(l=s.next()).done);i=!0)a()}catch(u){r=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}n.props.onContact&&n.props.onContact(e)},this.props=e,this.startPositions=Array.from({length:100}).map((function(t,e){return c().Common.random(-5,5)}));var i=this.height/(this.props.rows+2),r=Array.from({length:this.props.rows}).flatMap((function(t,e,r){var o=1+e,l=n.width*(e/(r.length-1)),a=1===o?0:l/(o-1);return Array.from({length:o}).map((function(t,r,o){var s=n.width/2-l/2+a*r,u=i*e+i/2;return c().Bodies.circle(s,u,11,{isStatic:!0,label:"Peg",plugin:{pegIndex:e*o.length+r}})}))})).slice(1);c().Composite.add(this.bucketComposite,this.makeBuckets()),c().Composite.add(this.engine.world,(0,s.Z)(r).concat([this.ballComposite,this.bucketComposite]))}var e=t.prototype;return e.makeBuckets=function(){var t=this,e=Array.from(new Set(this.props.multipliers)),n=(0,s.Z)(e).slice(1),i=(0,s.Z)(n).reverse(),r=[e[0],e[0],e[0]],o=(0,s.Z)(i).concat((0,s.Z)(r),(0,s.Z)(n)),l=o.length,a=this.width/l,u=Array.from({length:l+1}).map((function(e,n){var i=n*a;return c().Bodies.rectangle(i,t.height-36,4,72,{isStatic:!0,label:"Barrier",chamfer:{radius:2}})})),h=o.map((function(e,n){var i=n*a+a/2;return c().Bodies.rectangle(i,t.height-30,a-4,60,{isStatic:!0,isSensor:!0,label:"Bucket",plugin:{bucketIndex:n,bucketMultiplier:e}})}));return(0,s.Z)(h).concat((0,s.Z)(u))},e.single=function(){c().Events.off(this.engine,"collisionStart",this.collisionHandler),c().Runner.stop(this.runner),c().Events.on(this.engine,"collisionStart",this.collisionHandler),c().Composite.add(this.ballComposite,this.makePlinko(c().Common.random(-10,10),0)),c().Runner.run(this.runner,this.engine)},e.cleanup=function(){c().World.clear(this.engine.world,!1),c().Engine.clear(this.engine)},e.makePlinkos=function(){return this.startPositions.map(this.makePlinko)},e.getBodies=function(){return c().Composite.allBodies(this.engine.world)},e.reset=function(){c().Runner.stop(this.runner),c().Composite.clear(this.ballComposite,!1),c().Composite.add(this.ballComposite,this.makePlinkos())},e.simulate=function(t){var e=this.startPositions.map((function(t,e){return-1})),n=function(t,n){e[t.plugin.startPositionIndex]=n.plugin.bucketIndex},i=function(t){t.pairs.forEach((function(t){"Bucket"===t.bodyA.label&&"Plinko"===t.bodyB.label&&n(t.bodyB,t.bodyA),"Plinko"===t.bodyA.label&&"Bucket"===t.bodyB.label&&n(t.bodyA,t.bodyB)}))};c().Events.on(this.engine,"collisionStart",i),this.reset();for(var r=0;r<1e3;r++)c().Runner.tick(this.runner,this.engine,1);return c().Events.off(this.engine,"collisionStart",i),c().Runner.stop(this.runner),c().Composite.clear(this.ballComposite,!1),e.map((function(t,e){return{bucketIndex:t,plinkoIndex:e}})).filter((function(e){return e.bucketIndex===t}))},e.runAll=function(){c().Events.off(this.engine,"collisionStart",this.collisionHandler),c().Runner.stop(this.runner),c().Composite.clear(this.ballComposite,!1),c().Events.on(this.engine,"collisionStart",this.collisionHandler),c().Composite.add(this.ballComposite,this.makePlinkos()),c().Runner.run(this.runner,this.engine)},e.run=function(t){c().Events.off(this.engine,"collisionStart",this.collisionHandler);var e=c().Common.choose(this.bucketComposite.bodies.filter((function(e){return e.plugin.bucketMultiplier===t}))),n=this.simulate(e.plugin.bucketIndex);if(!n.length)throw new Error("Failed to simulate");console.log(n);var i=c().Common.choose(n);c().Events.on(this.engine,"collisionStart",this.collisionHandler),c().Composite.add(this.ballComposite,this.makePlinko(this.startPositions[i.plinkoIndex],i.plinkoIndex)),c().Runner.run(this.runner,this.engine)},t}(),f=n(7294),p=n(9531),d=n(4306),g=n(3495);var m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,10,10,10,15],b=[.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,1.5,3,3,3,3,3,3,3,6];function k(){var t=a.AX.useGame(),e=(0,p.dm)(),n=(0,r.Z)((0,a.re)(),2),s=n[0],u=n[1],c=(0,r.Z)(f.useState(!1),2),k=c[0],v=(c[1],(0,r.Z)(f.useState(!1),2)),y=v[0],x=v[1],C=(0,a.cT)({bump:"/games/plinko/bump.mp3",win:"/games/plinko/win.mp3",fall:"/games/plinko/fall.mp3"}),w=(0,g.h)(),P=(0,d.O)(),S=f.useRef({}),I=f.useRef({}),A=y?m:b,B=y?12:14,Z=f.useMemo((function(){return Array.from(new Set(A))}),[A]),E=function(t,e){var n=(0,r.Z)(f.useState(null),2),i=n[0],o=n[1];return f.useEffect((function(){var e=new h(t);return o(e),function(){return e.cleanup()}}),e),i}({rows:B,multipliers:Z,onContact:function(t){t.peg&&t.plinko&&(S.current[t.peg.plugin.pegIndex]=1,C.play("bump",{playbackRate:1+.05*Math.random()})),t.barrier&&t.plinko&&C.play("bump",{playbackRate:.5+.05*Math.random()}),t.bucket&&t.plinko&&(I.current[t.bucket.plugin.bucketIndex]=1,C.play(t.bucket.plugin.bucketMultiplier>=1?"win":"fall"))}},[B,Z]),R=function(){var n=(0,i.Z)((function(){var n;return(0,o.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.play({wager:s,bet:A})];case 1:return i.sent(),[4,e.result()];case 2:return n=i.sent(),E.reset(),E.run(n.multiplier),[2]}}))}));return function(){return n.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.AX.Portal,{target:"screen",children:(0,l.jsx)(a.AX.Canvas,{render:function(t,e){var n=t.ctx,i=t.size;if(E){var r=E.getBodies(),o=i.width/E.width,l=i.height/E.height,a=Math.min(o,l);n.clearRect(0,0,i.width,i.height),n.fillStyle="#0b0b13",n.fillRect(0,0,i.width,i.height),n.save(),n.translate(i.width/2-E.width/2*a,i.height/2-E.height/2*a),n.scale(a,a),k?(n.beginPath(),r.forEach((function(t,e){var i=t.vertices;n.moveTo(i[0].x,i[0].y);for(var r=1;r<i.length;r+=1)n.lineTo(i[r].x,i[r].y);n.lineTo(i[0].x,i[0].y)})),n.lineWidth=1,n.strokeStyle="#fff",n.stroke()):r.forEach((function(t,e){var i=t.label,r=t.position;if("Peg"===i){var o;n.save(),n.translate(r.x,r.y);var l=null!==(o=S.current[t.plugin.pegIndex])&&void 0!==o?o:0;S.current[t.plugin.pegIndex]&&(S.current[t.plugin.pegIndex]*=.9),n.scale(1+.4*l,1+.4*l);var a=(r.y+r.x+.05*Date.now())%360;n.fillStyle="hsla("+a+", 75%, 60%, "+.2*(1+2*l)+")",n.beginPath(),n.arc(0,0,15,0,2*Math.PI),n.fill();var s=75+25*l;n.fillStyle="hsla("+a+", 85%, "+s+"%, 1)",n.beginPath(),n.arc(0,0,11,0,2*Math.PI),n.fill(),n.restore()}if("Plinko"===i&&(n.save(),n.translate(r.x,r.y),n.fillStyle="hsla("+420*e%360+", 75%, 90%, .2)",n.beginPath(),n.arc(0,0,13.5,0,2*Math.PI),n.fill(),n.fillStyle="hsla("+420*e%360+", 75%, 75%, 1)",n.beginPath(),n.arc(0,0,9,0,2*Math.PI),n.fill(),n.restore()),"Bucket"===i){var u,c=null!==(u=I.current[t.plugin.bucketIndex])&&void 0!==u?u:0;I.current[t.plugin.bucketIndex]&&(I.current[t.plugin.bucketIndex]*=.9),n.save(),n.translate(r.x,r.y);var h=25+Z.indexOf(t.plugin.bucketMultiplier)/Z.length*125,f=.05+c;n.save(),n.translate(0,30),n.scale(1,1+2*c),n.fillStyle="hsla("+h+", 75%, 75%, "+f+")",n.fillRect(-25,-60,50,60),n.restore(),n.font="20px Arial",n.textAlign="center",n.fillStyle="hsla("+h+", 50%, 75%, 1)",n.lineWidth=5,n.lineJoin="miter",n.miterLimit=2;var p=75+25*c;n.fillStyle="hsla("+h+", 75%, "+p+"%, 1)",n.strokeText("x"+t.plugin.bucketMultiplier,0,0),n.stroke(),n.fillText("x"+t.plugin.bucketMultiplier,0,0),n.fill(),n.restore()}"Barrier"===i&&(n.save(),n.translate(r.x,r.y),n.fillStyle="#cccccc22",n.fillRect(-2,-36,4,72),n.restore())})),n.restore()}}})}),(0,l.jsxs)(a.AX.Portal,{target:"controls",children:[(0,l.jsx)(a.AX.WagerInput,{value:s,onChange:u}),(0,l.jsx)("div",{children:"Degen:"}),(0,l.jsx)(a.AX.Switch,{disabled:e.isPlaying,checked:y,onChange:x}),P.connected?(0,l.jsx)(a.AX.PlayButton,{onClick:function(){return R()},children:"Play"}):(0,l.jsx)(a.AX.Button,{main:!0,onClick:function(){P.wallet?P.connect():w.setVisible(!0)},children:"Play"})]})]})}},7568:function(t,e,n){function i(t,e,n,i,r,o,l){try{var a=t[o](l),s=a.value}catch(u){return void n(u)}a.done?e(s):Promise.resolve(s).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var l=t.apply(e,n);function a(t){i(l,r,o,a,s,"next",t)}function s(t){i(l,r,o,a,s,"throw",t)}a(void 0)}))}}n.d(e,{Z:function(){return r}})},253:function(t,e,n){n.d(e,{Z:function(){return a}});var i=n(9474),r=n(3375),o=n(3128),l=n(1566);function a(t,e){return(0,i.Z)(t)||(0,r.Z)(t,e)||(0,l.Z)(t,e)||(0,o.Z)()}},9815:function(t,e,n){n.d(e,{Z:function(){return l}});var i=n(943);var r=n(3375);var o=n(1566);function l(t){return function(t){if(Array.isArray(t))return(0,i.Z)(t)}(t)||(0,r.Z)(t)||(0,o.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);